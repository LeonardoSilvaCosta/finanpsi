"use strict";exports.id=503,exports.ids=[503],exports.modules={1503:(e,t,a)=>{a.r(t),a.d(t,{default:()=>c});class s{constructor(e=864e5,t=1e3){this.cache=new Map,this.maxAge=e,this.maxSize=t}generateLeadHash(e){let t=`${e.email}:${e.challenge||""}:${e.profession||""}:${e.groupAccepted}`;return Buffer.from(t).toString("base64").substring(0,50)}get(e){let t=this.generateLeadHash(e),a=this.cache.get(t);if(!a)return null;let s=Date.now()-a.timestamp;return s>this.maxAge?(this.cache.delete(t),null):(console.log(`[Cache] Diagn\xf3stico encontrado em cache (idade: ${Math.round(s/1e3)}s)`),a)}set(e,t,a){let s=this.generateLeadHash(e);if(this.cache.size>=this.maxSize){let e=Array.from(this.cache.entries()).sort((e,t)=>e[1].timestamp-t[1].timestamp)[0][0];this.cache.delete(e)}this.cache.set(s,{diagnosis:t,method:a,timestamp:Date.now(),leadHash:s}),console.log(`[Cache] Diagn\xf3stico armazenado em cache (m\xe9todo: ${a})`)}cleanExpired(){let e=Date.now(),t=0;for(let[a,s]of this.cache.entries())e-s.timestamp>this.maxAge&&(this.cache.delete(a),t++);return t>0&&console.log(`[Cache] ${t} entradas expiradas removidas`),t}clear(){this.cache.clear(),console.log("[Cache] Cache limpo completamente")}getStats(){let e=Date.now(),t=0,a=0;for(let s of this.cache.values())e-s.timestamp>this.maxAge?a++:t++;return{total:this.cache.size,valid:t,expired:a,maxSize:this.maxSize,maxAgeMs:this.maxAge}}}let i=new s(Number(process.env.DIAGNOSIS_CACHE_MAX_AGE_MS||864e5),Number(process.env.DIAGNOSIS_CACHE_MAX_SIZE||1e3));"undefined"!=typeof setInterval&&setInterval(()=>{i.cleanExpired()},36e5);let c=i}};